/*
* This file autogenerated;
*
* DO NOT EDIT
*
* {{ .Info.Title }}
* Version: {{ .Info.Version }}
*
*/

package server

const (
        NotFindRequiredArgErr = "not find required arg: %s"
        ParsingErr = "parsing error: %s for arg: %s"
        CannotReadRequestBodyErr = "can not read request body: %s"
        IncorrectRequestBodyErr = "incorrect request body: %s"
)

type (
    {{ range $_, $schema := .Components.Schemas }}
    	{{- $schema.RenderDefinition }}
    {{ end }}
)

{{ range $u, $p := .Paths -}}
    {{ range $m, $op := $p.GetMethodsMap -}}
        func {{ template "handlers_signature" $op -}}{
            {{- range $i, $arg := $op.Parameters}}
                {{- if or (eq $arg.In "query") (eq $arg.In "path")}}

                    {{- if eq $i 0 -}}
                        value :=
                    {{- else }}
                        value =
                    {{- end -}}
                    r.URL.Query().Get("{{- $arg.Name}}")
                    {{- if $arg.Required }}
                        if value == "" {
                            err = fmt.Errorf(NotFindRequiredArgErr,  "{{$arg.Name}}")
                            return
                        }
                    {{- end }}
                    {{($arg.RenderValueTo "value")}}
                    {{- if $arg.IsReturnsParsingError}}
                        if err != nil {
                            err = fmt.Errorf(ParsingErr, "{{$arg.Name}}", err.Error())
                            return
                        }
                    {{- end }}
                {{- else if eq $arg.In "body"}}
                    bs, errl := ioutil.ReadAll(r.Body)
                    if errl != nil {
                        err = fmt.Errorf(CannotReadRequestBodyErr, errl.Error())
                        return
                    }
                    err = json.Unmarshal(bs, &{{$arg.Name}})
                    if err != nil {
                        err = fmt.Errorf(IncorrectRequestBodyErr, string(bs))
                        return
                    }
                {{- end }}
            {{- end }}
            return
        }
    {{ end }}
{{- end }}